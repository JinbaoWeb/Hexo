title: 编译原理 代码优化
categories: [编译原理]
tags: [编译原理,代码优化,DAG]
date: 2016-05-13 14:21:32
---
## 一、优化技术

1.1 删除多余运算（删除公共子表达式）

1.2 代码外提

把循环不变运算，即其结果独立于循环执行次数的表达式，提到循环外面，使之只在循环外计算一次。

1.3 强度削弱

把强度大的运算换算成强度小的运算。

1.4 变化循环控制条件

1.5 合并已知量与复写传播

1.6 删除无用赋值

<!--more-->

## 二、局部优化

局部优化是指基本块内的优化。

基本块是指程序中一个顺序执行的语句序列，其中只有一个入口语句和一个出口语句。

入口语句：

- 1.程序的第一语句；或者，
- 2.条件转移语句或无条件转移语句的转移目标语句；或者，
- 3.紧跟在条件转移语句后面的语句

### 2.1 基本块的划分

划分基本快的算法：

- 1.求出四元式程序中各个基本块的入口语句。
- 2.对每一个入口语句，构造其所属的基本块。它是由该语句到下一入口语句（不包括下一入口语句），或到一转移语句（包括该转移语句），或到一停语句（包括该停语句）之间的语句序列组成的。
- 3.凡是被纳入某一基本块的语句，都是程序控制流程无法到达的语句，因而也是不会被执行到的语句，我们可以把它们删除。

### 2.2 基本块的变换

基本块的主要保结构变换：
- 1.删除公共子表达式
- 2.删除无用代码
- 3.重新命名临时变量
- 4.交换语句次序


### 2.3 基本块DAG表示及其应用

**叶结点**：无后继的结点，以一标识符（名字，常数）标记，表示该结点代表该常量或常数的值。如果叶子结点代表该变量A的地址，则addr（A）作为该结点的信息。

**内部结点**：即有后继的结点，以运算符号标记表示该结点代表应用该运算符对其后继结点所表示的值进行运算的结果。

**各个结点**：图中各结点可能附加一个或多个标识符标记表示这些变量具有该结点表示的值。

四元式与DAG结点：
![](/img/Compilers/99.jpg)