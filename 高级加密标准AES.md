title: 高级加密标准AES
categories: [网络安全理论与应用]
tags: [网络安全理论与应用,密码学,AES]
date: 2016-05-19 15:22:49
---
# 一、AES算法原理

&nbsp;&nbsp;&nbsp;&nbsp;AES 算法基于排列和置换运算。排列是对数据重新进行安排，置换是将一个数据单元替换为另一个。AES 使用几种不同的方法来执行排列和置换运算。

&nbsp;&nbsp;&nbsp;&nbsp;AES 是一个迭代的、对称密钥分组的密码，它可以使用128、192 和 256 位密钥，并且用 128 位（16字节）分组加密和解密数据。与公共密钥密码使用密钥对不同，对称密钥密码使用相同的密钥加密和解密数据。通过分组密码返回的加密数据的位数与输入数据相同。迭代加密使用一个循环结构，在该循环中重复置换和替换输入数据。

<!--more-->

# 二、AES算法的结构

![](/img/Network/6.jpg)

&nbsp;&nbsp;&nbsp;&nbsp;AES算法由N轮循环构成，在N轮循环之前，16B的明文分组首先经过加轮密钥变换，其结果的输出状态作为第1轮循环的输入。除最后一轮循环外，每轮循环的轮函均由面向字节的4个变换组成：
（1）字节替换：使用一个S盒完成分组的字节到字节的替代；
（2）移行：对每一行的字节执行简单的置换；
（3）混列：利用有限域GF（$2^8$）上的算术特性执行替代；
（4）加轮密钥：将当前分组与相应的扩展密钥执行按位异或操作。

&nbsp;&nbsp;&nbsp;&nbsp;AES加密算法的最后一轮中，仅执行字节替代、移行和加轮密钥操作，这是由AES算法的特定结构决定的，也是密码算法可逆性所要求的。

&nbsp;&nbsp;&nbsp;&nbsp;在AES算法中，密钥由密钥扩展过程扩展至由4$\times$($N_r$+1)个字组成的序列，其中每个字是4个字节，表示为数组$w$[i],$0 \leq i < 4 \times (N_r + 1)$.

&nbsp;&nbsp;&nbsp;&nbsp;AES加密和解密过程中，仅仅在加轮密钥变换中使用了扩展密钥，因此算法以加轮密钥开始，以加轮密钥结束。这是因为，若将其他不需要密钥的运算用于算法的开始或结束阶段，则在不知道密钥的情况下即可计算其逆，故不能增加算法的安全性。

&nbsp;&nbsp;&nbsp;&nbsp;AES算法的每个面向字节变换均可逆，对于字节替代、移行和混列变换，在AES解密算法中使用了其对应的逆过程，即逆字节替代、逆移行和逆混列变换。由于加轮密钥的逆变换使用相同的轮密钥和分组异或，是自逆的，因而其逆变过程即是其本身。

&nbsp;&nbsp;&nbsp;&nbsp;AES解密算法与加密算法具有相似的结构，解密算法以加密算法相反的次序使用扩展密钥。

# 三、AES算法的密钥扩展

AES算法在进行加密和解密变换时，需要将状态与轮密钥进行多轮的按位异或，加密操作共需要$N_r$+1个轮密钥。因此，在进行加密之前先要由密钥K生成扩展密钥，AES密钥扩展算法的输入时密钥的长度，即$N_k$个字，而输出的扩展密钥由$4 \times (N_r + 1)$,每个字是4个字节，表示为数组$w$[i],$0 \leq i < 4 \times (N_r + 1)$.

AES密钥扩展过程：
（1）输入密钥K被直接复制到扩展密钥数组的前4个字；
（2）每次使用4个字填充密钥数组余下的部分，在扩展密钥数组中，每一个新增的$w$[i]的值依赖于$w$[i-1]和$w$[i-4]。