title: 对称密码
categories: [网络安全理论与应用]
tags: [网络安全理论与应用,密码学,对称密码]
date: 2016-05-18 23:44:23
---
# 一、对称密码的模型

> 在使用对称密码的通信系统中，通信双方使用相同的加密密钥和解密密钥，即在对称密码算法中，加/解密密钥是相同的，又被称为秘密密钥。

在对称密码模型中，密钥既可以由通信双方的任一方产生，也可以由通信双方共同依赖的第三方产生。
若对称加密算法使用的密钥由通信的任一方产生，则首先需要完成密钥的分配，将该密钥由安全通道发送给通信的另一方。此时发送端将明文M输入加密算法E，使用密钥K对其进行加密生成密文C，密文C经通信信道发送给接收端，由接收端应用解密算法D和密钥K对密文C进行解密，恢复明文M。
若在对称加密算法使用的密钥由可信的第三方产生，则需要将生成的密钥经由安全通道分发给通信双方。此时，发送端和接收端各自使用加密/解密算法和接收到的秘密密钥完成密文的生成和明文的恢复工作。

<!--more-->

# 二、对称密码体制的安全性

> 一般而言，对称密码体制的安全性取决于加密算法和密钥。

加密算法的强度必须足够高，使得攻击者仅根据密文就能破译出明文在计算上是不可行的。一个好的加密算法应该能够抵御已知明文攻击。

密钥对安全的影响主要包括两个方面：密钥的长度和密钥更新的频度。
密钥越长，系统抗穷举攻击的能力越强；密钥更新的频率越高，密码系统的安全性越好。因此密钥的长度必须足够长；密钥更新的频度必须足够高。

# 三、序列密码(流密码)

在该密码体制中，将明文P看成连续的比特流(或字符流) $p_1$ $p_2$ …，用密钥序列 K=$k_1$ $k_2$ …中的第i个元素$k_i$ 对明文中的第i个元素$p_i$ 进行加密。
即：$E_K$($P$)=$E_{K_1}$($p_1$)  $E_{K_2}$($p_2$) …

序列密码的工作过程示意

![](/img/Network/2.jpg)

这种体制的保密性完全在于密钥的随机性。如果密钥是真正的随机数，则这种体制就是理论上不可破的。这也称为一次一密乱码本体制。
该体制所需的密钥量很大，目前常用伪随机序列的密钥序列，序列周期一般为$10^{50}$

# 四、分组密码

## 4.1 扩散与扰乱

> 扩散与扰乱的出现是因为，通常在明文中的信息具有一定的统计特征，若这种统计特征以某种方式反映在密文中，则密码分析者就有可能推测出加密密钥，或部分密钥。

扩散的基本方法是让明文和密钥的每个字母影响尽可能多的密文字母的取值（等价于每个密文字母被尽可能多的明文和密钥字母影响），从而使得明文和密钥统计特征被扩散，密文中各种字母和多字母组合的出现频率比在明文和密钥中出现的频率均匀得多，明文和密钥中原有的统计特征不再反映在密文中。

扰乱机制是使密文的统计特征与明文和加密密钥的关系尽可能复杂化，使得攻击者即使掌握了密文的某些统计特征，也很难从中推测出密钥和明文。

## 4.2 Feistel分组密码结构

采用n轮循环的Feistel加密/解密算法结构

![](/img/Network/3.jpg)

Feistel分组密码结构中，加密算法的输入时长度为2w bit的明文和密钥K。
其加密算法如下：

> 首先，利用密钥K生成n个子密钥($K_1,K_2,...,K_n$)
> 明文分组被分为左右等长的两部分($LE_0,RE_0$),分组的这两个部分经过n轮处理后，左右部分再进行交换，最后组合起来产生密文分组C。
> n轮循环的每一轮结构相同。以第i轮为例，该轮循环以前一轮的输出 （$LE_{i-1}$ , $RE_{i-1}$ ）以及子密钥$K_i$作为输入，对分组的左边部分$LE_{i-1}$进行替代操作，替代的方法是对分组的右边部分$RE_{i-1}$和子密钥$K_i$应用轮函数$F$进行变换，然后将$F$函数的输出与分组的左边部分$LE_{i-1}$进行异或操作。替代操作之后，算法使用置换操作将分组的左右两个部分进行交换，得到本轮循环的输出（$LE_i$ , $RE_i$ ）。

Feistel加密算法描述

$LE_0 = (P)_{LW}$;
$RE_0 = (P)_{RW}$;
$for i=1 step 1 to n do$
&nbsp;&nbsp;&nbsp;&nbsp;    $LE_i=RE_{i-1}$;
&nbsp;&nbsp;&nbsp;&nbsp;    $RE_i=LE_{i-1}\bigoplus F(RE_{i-1},K_i)$;
$end for$
$LE_{n+1}=RE_n$;
$RE_{n+1}=LE_n$;
$C=LE_{n+1}||RE_{n+1}$;

其中$(P)_{LW}$表示明文分组$P$的长度为$w$的左边部分，$(P)_{RW}$表示明文分组$P$的长度为$w$的右边部分，||表示连接。

Feistel解密过程与其加密过程是相同的，即加密与解密使用相同的算法。解密算法的输入时长度为2$w$bit的密文分组$C$，以及利用密钥$K$生成n个子密钥($K_1,K_2,...,K_n$)。与加密算法不同，解密算法在n轮循环时使用子密钥的顺序与加密时相反，即在第1轮循环时使用子密钥$K_n$，在最后一轮（即n轮）循环时使用子密钥$K_1$。

Feistel解密算法描述

$LD_0 = (C)_{LW}$;
$RD_0 = (C)_{RW}$;
$for i=1 step 1 to n do$
&nbsp;&nbsp;&nbsp;&nbsp;    $LD_i=RD_{i-1}$;
&nbsp;&nbsp;&nbsp;&nbsp;    $RD_i=LD_{i-1}\bigoplus F(RD_{i-1},K_{n-i+1})$;
$end for$
$LD_{n+1}=RD_n$;
$RD_{n+1}=LD_n$;
$C=LD_{n+1}||RD_{n+1}$;

### 4.2.1 分组长度

分组越长安全性越高，但加密/解密处理速度也就越慢。

### 4.2.2 密钥长度

密钥越长安全性越高，但加密/解密速度越慢。

### 4.2.3 循环次数

循环次数越多安全性越高

### 4.2.4 子密钥生成算法

在Feistel算法的多轮循环中，需要使用不同的子密钥，子密钥生成算法越复杂，抵御密码分析的能力就越强。

### 4.2.5 轮函数

轮函数（$F$）越复杂，其扩散与扰乱功能越强，则抵御密码分析的能力也就越强。

# 五、分组密码的操作模式

## 5.1 电子密码模式

> 电子密码本(ECB)：最基本的操作模式。

### 5.1.1 电子密码模式原理

将明文$P$划分为长度为$w$ 比特的明文分组($P_1, P_2, … , P_n$ ) 最后一个分组通常需要填空。
每个明文分组使用同样的密钥$K$进行加密。
每个明文分组在加密时独立处理。
$w$ 比特的明文分组与 $w$ 比特的密文分组一一对应。类似密码本。

### 5.1.2 电子密码本模式示意图

![](/img/Network/4.jpg)

### 5.1.2 电子密码本模式特点

相同的明文分组产生相同的密文分组。
易受统计分析攻击。
可并行处理，加、解密速度快，应用广泛。


## 5.2 密码分组链接模式(CBC)

### 5.2.1 密码分组链接模式原理

将明文$P$分组($P_1, P_2,	… , P_n$ ) 。
每个明文分组使用同样的密钥K进行加密。
每个明文分组在加密前，先与上一次加密输出的密文分组进行按位异或，而后再进行加密处理。
对第一个明文分组进行处理时，还没有密文分组可用，需要引入一个初始向量$IV$与该分组异或。

### 5.2.2 密码分组链接模式示意图

![](/img/Network/5.jpg)

### 5.2.3 密码分组链接模式特点

通过将明文分组与前一个密文分组异或，实现了明文模式的隐藏，抗统计分析攻击。
不能并行加密，加密速度较慢。
适用于高结构化信息的加密传输。

## 5.3 密码反馈模式和输出反馈模式

由于上述两种模式在分组时要对明文进行填充，对于大量短小信息进行加密时，增加了不必要的开销。
密码反馈模式将分组密码转换为序列密码进行加密处理。

